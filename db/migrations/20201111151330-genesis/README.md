# Migration `20201111151330-genesis`

This migration has been generated by Ray Andrew at 11/11/2020, 10:13:30 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "User" (
"id" SERIAL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "name" TEXT,
    "email" TEXT NOT NULL,
    "hashedPassword" TEXT,
    "roles" TEXT[],

    PRIMARY KEY ("id")
)

CREATE TABLE "Session" (
"id" SERIAL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "expiresAt" TIMESTAMP(3),
    "handle" TEXT NOT NULL,
    "userId" TEXT,
    "hashedSessionToken" TEXT,
    "antiCSRFToken" TEXT,
    "publicData" TEXT,
    "privateData" TEXT,
    "userId_SessionToUser" INTEGER,

    PRIMARY KEY ("id")
)

CREATE TABLE "Journal" (
"id" SERIAL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "day" INTEGER NOT NULL,
    "month" INTEGER NOT NULL,
    "year" INTEGER NOT NULL,
    "am" TEXT,
    "pm" TEXT,
    "published" BOOLEAN NOT NULL DEFAULT false,

    PRIMARY KEY ("id")
)

CREATE TABLE "Tag" (
"id" SERIAL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "name" TEXT NOT NULL,
    "lightColor" TEXT NOT NULL DEFAULT E'teal.800',
    "darkColor" TEXT NOT NULL DEFAULT E'teal.200',

    PRIMARY KEY ("id")
)

CREATE TABLE "_JournalToTag" (
    "A" INTEGER NOT NULL,
    "B" INTEGER NOT NULL
)

CREATE UNIQUE INDEX "User.email_unique" ON "User"("email")

CREATE UNIQUE INDEX "Session.handle_unique" ON "Session"("handle")

CREATE UNIQUE INDEX "Tag.name_unique" ON "Tag"("name")

CREATE UNIQUE INDEX "_JournalToTag_AB_unique" ON "_JournalToTag"("A", "B")

CREATE INDEX "_JournalToTag_B_index" ON "_JournalToTag"("B")

ALTER TABLE "Session" ADD FOREIGN KEY("userId_SessionToUser")REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "_JournalToTag" ADD FOREIGN KEY("A")REFERENCES "Journal"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "_JournalToTag" ADD FOREIGN KEY("B")REFERENCES "Tag"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201111151330-genesis
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,62 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "postgres"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+// --------------------------------------
+
+model User {
+  id             Int       @id @default(autoincrement())
+  createdAt      DateTime  @default(now())
+  updatedAt      DateTime  @updatedAt
+  name           String?
+  email          String    @unique
+  hashedPassword String?
+  roles          String[]
+  sessions       Session[]
+}
+
+model Session {
+  id                   Int       @id @default(autoincrement())
+  createdAt            DateTime  @default(now())
+  updatedAt            DateTime  @updatedAt
+  expiresAt            DateTime?
+  handle               String    @unique
+  userId               String?
+  hashedSessionToken   String?
+  antiCSRFToken        String?
+  publicData           String?
+  privateData          String?
+  user                 User?     @relation(fields: [userId_SessionToUser], references: [id])
+  userId_SessionToUser Int?
+}
+
+model Journal {
+  id        Int      @id @default(autoincrement())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  day       Int
+  month     Int
+  year      Int
+  am        String?
+  pm        String?
+  published Boolean  @default(false)
+  tags      Tag[]
+}
+
+model Tag {
+  id         Int       @id @default(autoincrement())
+  createdAt  DateTime  @default(now())
+  updatedAt  DateTime  @updatedAt
+  name       String    @unique
+  lightColor String    @default("teal.800")
+  darkColor  String    @default("teal.200")
+  journals   Journal[]
+}
```


